/* =========================================
   変数定義（色・レイアウト調整用）
   ========================================= */
:root {
    /* --- ② 色の提案（ライトテーマ） --- */
    --color-bg: #f8f8f8;          /* 背景色: 薄いオフホワイト */
    --color-card-bg: #fff;        /* カードの背景色: 白 */
    --color-text: #333;           /* 本文色: 濃いグレー */
    --color-header-bg: #fff;      /* ヘッダー背景 */
    --color-shadow: rgba(0, 0, 0, 0.08); /* 影の色 */
    
    /* --- ① レイアウト調整変数 --- */
    --section-gap: 3rem;          /* シーン（カード）間の垂直方向の間隔 */
    --card-vertical-padding: 1.5rem; /* カードの上下の余白 */
    --card-horizontal-padding: 1rem; /* カードの左右の余白 */
    
    /* ★修正: 読み物エリアの全体幅を制御する変数に変更 */
    --reading-area-width-pc: 50vw; /* PCでの読み物エリアの幅 */
    
    --page-max-width: 900px;
}

/* --- ② 色の提案（ダークテーマ：自動適用） --- */
@media (prefers-color-scheme: dark) {
    :root {
        --color-bg: #0d0d0c;        /* 背景色: 墨黒 */
        --color-card-bg: #1c1c1a;   /* カードの背景色: 濃いグレー */
        --color-text: #f0f0f0;      /* 本文色: 白 */
        --color-header-bg: #1c1c1a;
        --color-shadow: rgba(255, 255, 255, 0.05);
    }
}

/* =========================================
   基本リセット
   ========================================= */
html, body {
    /* --- ③ 横スクロールの固定（最優先） --- */
    overflow-x: hidden; 
}

body {
    background-color: var(--color-bg);
    color: var(--color-text);
    font-family: 'Yu Mincho', 'Hiragino Mincho ProN', 'Noto Serif JP', serif;
    line-height: 1.8;
    margin: 0;
    padding: 0;
    overflow-y: auto;
}

/* =========================================
   ヘッダー（ナビゲーション）
   ========================================= */
.story-header {
    background: var(--color-header-bg);
    border-bottom: 1px solid var(--color-shadow);
    /* ... 既存スタイルを維持 ... */
}

/* =========================================
   本文メインエリア
   ========================================= */
.story-main {
    max-width: var(--page-max-width);
    margin: 0 auto;
    padding: 2rem 1rem;
}

.story-content-flow {
    display: flex;
    flex-direction: column;
    gap: var(--section-gap); 
    
    /* ★修正: PCでの幅を制限し、右寄せを維持 */
    width: var(--reading-area-width-pc);
    margin-left: auto; /* 右寄せの実現 */
    max-width: 100%; /* モバイルでは100%を維持 */
}

/* =========================================
   【核心】縦書きブロック (.scene-card)
   ========================================= */
.scene-card {
    display: flex;
    justify-content: flex-end; 
    
    padding: var(--card-vertical-padding) var(--card-horizontal-padding); 
    
    background: var(--color-card-bg);
    box-shadow: 0 4px 10px var(--color-shadow);
    border-radius: 8px;
    
    /* ★修正: 親要素 (story-content-flow) の幅に収まるようにする */
    width: 100%;
}

.scene-card p {
    writing-mode: vertical-rl;
    text-orientation: upright;
    
    height: auto; 
    
    /* ★★★ 根本修正: ④はみ出しの問題を解決するため、width を削除 ★★★ */
    /* width: var(--reading-column-width); を削除 */
    width: auto; 

    /* ★★★ 根本修正: ⑤ 行間が長すぎる問題を解決 ★★★ */
    margin: 0; /* デフォルトマージンのリセット */

    /* 縦書きの列（段落）の間隔を制御 */
    margin-inline-start: 2em; /* 1.5em から 2em に調整 */
    margin-block-start: 1em; /* 1字下げ */

    /* ★修正: 行の間の縦のスペースを詰める */
    line-height: 1.8; 
    
    /* ★追加: テキストがカード内で確実に折り返すようにする */
    white-space: normal;
}

/* pタグが連続する場合の最初の字下げを解除 */
.scene-card p:first-of-type {
    margin-block-start: 0;
}

/* =========================================
   スマホ用調整 (max-width: 640px)
   ========================================= */
@media (max-width: 640px) {
    /* 縦長でも画面幅いっぱいに読み物エリアを使う */
    .story-content-flow {
        width: 100%;
        margin: 0 auto;
    }
}
