<!DOCTYPE html>
<html lang="{{ site.lang | default: 'ja' }}">
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {% seo %}

    <!-- 共通スタイル -->
    <link rel="stylesheet"
          href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">

    <!-- ▼ 原稿ページ専用：ここでスマホレイアウトを強制的に上書きする ▼ -->
    <style>
      /* テーマ側の height:100% / overflow:hidden を無効化 */
      html,
      body {
        height: auto !important;
        min-height: 100% !important;
        overflow-x: hidden !important;
        overflow-y: auto !important;
        box-sizing: border-box;
      }

      /* 640px 以下だけ、スマホレイアウトに切り替え */
      @media (max-width: 640px) {

        body.manuscript-page {
          margin: 0;
          padding: clamp(0.75rem, 4vw, 1.5rem);
          padding-top: clamp(3.5rem, 14vw, 5rem); /* ヘッダーと本文の距離 */
          min-height: 100vh;
        }

        .manuscript-main,
        .manuscript-flow,
        .manuscript-pagebody {
          width: 100%;
          margin: 0;
          padding: 0;
          display: block;
        }

        .manuscript-flow {
          overflow: visible;
          -webkit-overflow-scrolling: touch;
        }

        /* ★ スマホの本文レイアウト本体 ★ */
        .manuscript-entry {
          width: auto;
          max-width: 100%;
          column-count: 1;      /* スマホは 1 列固定 */
          column-gap: 0;

          writing-mode: vertical-rl;
          text-orientation: mixed;

          font-size: 0.9rem;    /* 1 行の文字数を増やしたいならここ */
          line-height: 1.7;     /* 行間 */
          letter-spacing: 0.08em;

          white-space: normal;  /* 折り返しOK（これ大事） */
        }

        .manuscript-entry p {
          display: block;
          margin: 0 0 0.9rem 0; /* 段落間の余白 */
          text-indent: 1em;     /* 1字下げ */
        }

        .manuscript-entry p:last-child {
          margin-bottom: 0.75rem;
        }
      }
    </style>
  </head>

  <body class="manuscript-page">
    <main class="manuscript-main">
      {% assign prev_label = page.prev_label %}
      {% assign next_label = page.next_label %}
      {% if page.prev_page and prev_label == nil %}
        {% assign prev_target = site.pages | where: 'url', page.prev_page | first %}
        {% if prev_target %}
          {% assign prev_label = prev_target.section_title | default: prev_target.title %}
        {% endif %}
      {% endif %}
      {% if page.next_page and next_label == nil %}
        {% assign next_target = site.pages | where: 'url', page.next_page | first %}
        {% if next_target %}
          {% assign next_label = next_target.section_title | default: next_target.title %}
        {% endif %}
      {% endif %}

      <div class="manuscript-meta" aria-label="章ナビゲーション">
        {% if page.prev_page and prev_label %}
          <a class="manuscript-meta__link manuscript-meta__link--prev"
             href="{{ page.prev_page | relative_url }}">{{ prev_label }}</a>
        {% else %}
          <span class="manuscript-meta__placeholder" aria-hidden="true"></span>
        {% endif %}

        <a class="manuscript-meta__link manuscript-meta__link--home"
           href="{{ '/manuscript.html' | relative_url }}">{{ site.title }}</a>

        {% if page.next_page and next_label %}
          <a class="manuscript-meta__link manuscript-meta__link--next"
             href="{{ page.next_page | relative_url }}">{{ next_label }}</a>
        {% else %}
          <span class="manuscript-meta__placeholder" aria-hidden="true"></span>
        {% endif %}
      </div>

      <section class="manuscript-flow" aria-label="原稿">
        <div class="manuscript-pagebody">
          <article class="manuscript-entry">
            {{ content }}
          </article>
        </div>
      </section>
    </main>
  </body>
</html>
